# Migration `20201113203459-add-kanji-vocab`

This migration has been generated by Thomas Farla at 11/13/2020, 9:34:59 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
PRAGMA foreign_keys=OFF;
CREATE TABLE "new_VocabularyKanji" (
    "id" TEXT NOT NULL,
    "createdAt" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "vocabularyId" TEXT,
    "kanjiCharacter" TEXT,

    FOREIGN KEY ("vocabularyId") REFERENCES "Vocabulary"("id") ON DELETE SET NULL ON UPDATE CASCADE,
    FOREIGN KEY ("kanjiCharacter") REFERENCES "Kanji"("character") ON DELETE SET NULL ON UPDATE CASCADE,
PRIMARY KEY ("id")
);
INSERT INTO "new_VocabularyKanji" ("id", "vocabularyId", "createdAt", "updatedAt") SELECT "id", "vocabularyId", "createdAt", "updatedAt" FROM "VocabularyKanji";
DROP TABLE "VocabularyKanji";
ALTER TABLE "new_VocabularyKanji" RENAME TO "VocabularyKanji";
PRAGMA foreign_key_check;
PRAGMA foreign_keys=ON
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201113203152-add-vocab..20201113203459-add-kanji-vocab
--- datamodel.dml
+++ datamodel.dml
@@ -1,9 +1,9 @@
 datasource DS {
   // optionally set multiple providers
   // example: provider = ["sqlite", "postgresql"]
   provider = "sqlite"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider      = "prisma-client-js"
@@ -19,22 +19,22 @@
   furigana           String
   jlpt               Int?
   author             User                 @relation(fields: [userId], references: [id])
   userId             String
-  VocabularySentence VocabularySentence[]
   createdAt          DateTime             @default(now())
   updatedAt          DateTime             @default(now())
   VocabularyKanji    VocabularyKanji[]
+  VocabularySentence VocabularySentence[]
 }
 model VocabularyKanji {
-  id           String     @id @default(cuid())
-  vocabulary   Vocabulary @relation(fields: [vocabularyId], references: [id])
-  sentence     Sentence   @relation(fields: [sentenceId], references: [id])
-  vocabularyId String
-  sentenceId   String
-  createdAt    DateTime   @default(now())
-  updatedAt    DateTime   @default(now())
+  id             String      @id @default(cuid())
+  createdAt      DateTime    @default(now())
+  updatedAt      DateTime    @default(now())
+  Vocabulary     Vocabulary? @relation(fields: [vocabularyId], references: [id])
+  vocabularyId   String?
+  Kanji          Kanji?      @relation(fields: [kanjiCharacter], references: [character])
+  kanjiCharacter String?
 }
 model Sentence {
   id                 String               @id @default(cuid())
@@ -42,9 +42,8 @@
   KanjiSentence      KanjiSentence[]
   VocabularySentence VocabularySentence[]
   createdAt          DateTime             @default(now())
   updatedAt          DateTime             @default(now())
-  VocabularyKanji    VocabularyKanji[]
 }
 model VocabularySentence {
   id           String     @id @default(cuid())
@@ -66,20 +65,21 @@
   updatedAt      DateTime @default(now())
 }
 model Kanji {
-  character     String          @id
-  jlpt          Int?
-  frequency     Int?
-  rtkOldIndex   Int?
-  rtkNewIndex   Int?
-  WaniKaniIndex Int?
-  meaning       String?
-  author        User            @relation(fields: [userId], references: [id])
-  userId        String
-  KanjiSentence KanjiSentence[]
-  createdAt     DateTime        @default(now())
-  updatedAt     DateTime        @default(now())
+  character       String            @id
+  jlpt            Int?
+  frequency       Int?
+  rtkOldIndex     Int?
+  rtkNewIndex     Int?
+  WaniKaniIndex   Int?
+  meaning         String?
+  author          User              @relation(fields: [userId], references: [id])
+  userId          String
+  KanjiSentence   KanjiSentence[]
+  createdAt       DateTime          @default(now())
+  updatedAt       DateTime          @default(now())
+  VocabularyKanji VocabularyKanji[]
 }
 model User {
   id         String       @id @default(cuid())
```


